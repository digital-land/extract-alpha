{%- from "govuk/components/tag/macro.njk" import govukTag -%}
{%- from "govuk/components/button/macro.njk" import govukButton -%}

{% macro extractionList(jobs) %}


<table class="govuk-table extraction-list">
	<thead class="govuk-table__head">
		<tr class="govuk-table__row">
			<th class="govuk-table__header">Title</th>
			<th class="govuk-table__header">Type</th>
			<th class="govuk-table__header">Status</th>
			<th class="govuk-table__header">Created</th>
			<th class="govuk-table__header">Actions</th>
		</tr>
	</thead>
	<tbody class="govuk-table__body">
		{% if jobs.length %}
			{% for job in jobs %}
				{% if job.id %}

					{% set jobPath = basePath ~ "extractions/" ~ job.id %}
					<tr class="govuk-table__row">
						<td class="govuk-table__cell">
							<a class="govuk-link" href="{{ jobPath }}">{{ job.title }}</a>
						</td>
						<td class="govuk-table__cell">{{ job.job_type | docType }}</td>
						<td class="govuk-table__cell">

							<status-checker job-id="{{ job.id }}" job-title="{{ job.title }}">
								{{ govukTag({
									text: job.status
								}) }}
							</status-checker>

						</td>
						<td class="govuk-table__cell">
							{{ job.created_datetime | date("dd/mm/yy hh:mm") }}</td>
						<td class="govuk-table__cell">
							{{
								govukButton({
									html: "Delete <span class='govuk-visually-hidden'>extraction " ~ job.title ~ " created on " ~ (job.created_datetime | date("dd/mm/yy hh:mm")) ~ "</span>",
									type: "submit",
									href: basePath ~ "extractions/" ~ job.id ~ "/delete",
									classes: "govuk-button--secondary"
								})
							}}
						</td>
					</tr>
				{% endif %}
			{% endfor %}
		{% else %}
			<tr class="govuk-table__row">
				<td class="govuk-table__cell" colspan="5">No extractions found</td>
			</tr>
		{% endif %}
	</tbody>
</table>


{% endmacro %}